var toot = {
    //gravity: (300 * 0.27),
    gravity: 300,
    fartStrength: 250,
    currentDistance: 0,

    // namespacing
    character: {},
    environment: {},
    obstacle: {},
    ui: {}
};



var run = function() {

    var stats = new Stats();
    document.body.appendChild(stats.domElement);
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.top = '0px';

    var game = new Phaser.Game(
        1334, 750,
        Phaser.AUTO,
        '', {
            preload: preload,
            create: create,
            update: update
        });

    //var cursors;
    var player = new toot.character.Player(game);
    var ground = new toot.environment.Ground(game);
    var background = new toot.environment.Background(game);

    var obstacleGenerator = new toot.obstacle.Generator(game);
    var uiDistance = new toot.ui.Distance(game);

    var vignette = new toot.environment.Vignette(game);


    function preload () {
        background.preload();
        ground.preload();
        player.preload();
        vignette.preload();

        obstacleGenerator.preload();

        uiDistance.preload();
    }

    function create () {

        game.physics.startSystem(Phaser.Physics.ARCADE);

        game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
        game.scale.pageAlignHorizontally = true;
        game.scale.pageAlignVertically = true;
        game.scale.setScreenSize(true);
        game.scale.refresh();

        // Create game objects
        background.create();
        ground.create();
        player.create();


        obstacleGenerator.create();

        uiDistance.create();

        vignette.create();
    }

    function update() {
        stats.begin();

        game.physics.arcade.collide(player.getColliders(), ground.getColliders());

        background.update();
        ground.update();
        player.update();

        obstacleGenerator.update();

        uiDistance.update();

        toot.currentDistance++;

        stats.end();
    }

};


toot.character.Player = function(game) {
    this.game = game;
    this.sprite = null;
};

toot.character.Player.prototype.preload = function() {
    this.game.load.spritesheet('dude', 'images/dude.png', 64, 96);
};

toot.character.Player.prototype.create = function() {
    // player
    var startX = this.game.world.width * 0.15;
    var startY = this.game.world.height - 256;

    this.sprite = this.game.add.sprite(startX, startY, 'dude');
    this.game.physics.arcade.enable(this.sprite);
    //this.sprite.body.bounce.y = 0.1;
    this.sprite.body.gravity.y = toot.gravity;
    this.sprite.body.collideWorldBounds = true;

    //this.sprite.animations.add('right', [5, 6, 7, 8], 10, true);
    this.sprite.animations.add('run', [5, 6, 7, 8], 5, true);
    this.sprite.animations.add('land', [5, 6, 7, 8], 3, true);
};

toot.character.Player.prototype.update = function(cursors) {
    //  Reset the players velocity (movement)
    this.sprite.body.velocity.x = 0;

    //console.log(this.sprite.body.velocity.y);

    if (this.game.input.activePointer.isDown) {
        this.sprite.body.velocity.y = toot.fartStrength * -1;
    }

    if (this.sprite.body.touching.down) {
        this.sprite.animations.play('run');
    }
    else if (this.sprite.body.velocity.y > 0 &&
             this.sprite.body.velocity.y > (toot.fartStrength * 0.66)) {
        this.sprite.animations.play('land');
    }
    else {
        this.sprite.frame = 8;
    }

};

toot.character.Player.prototype.getColliders = function() {
    return this.sprite;
};


toot.environment.Background = function(game) {
    this.game = game;
};

toot.environment.Background.prototype.preload = function() {
    this.game.load.image('bg-space', 'images/bg-space.jpg');
    this.game.load.image('bg-stars-small', 'images/bg-stars-small.png');
    this.game.load.image('bg-stars-dense', 'images/bg-stars-small-dense.png');
    this.game.load.image('bg-stars-large', 'images/bg-stars-large.png');

    this.game.load.image('bg-horizon', 'images/bg-horizon-gradient.png');
    this.game.load.image('bg-mountains-01', 'images/bg-mountains-01.png');
    this.game.load.image('bg-mountains-02', 'images/bg-mountains-02.png');
};

toot.environment.Background.prototype.create = function() {
    var w = this.game.world.width;
    var h = this.game.world.height;
    this.spaceBg = this.game.add.tileSprite(0, 0, w, h, 'bg-space');
    this.starsLg = this.game.add.tileSprite(0, 0, w, h, 'bg-stars-large');
    this.spaceDs = this.game.add.tileSprite(0, 0, w, h, 'bg-stars-dense');
    this.starsSm = this.game.add.tileSprite(0, 0, w, h, 'bg-stars-small');

    this.horizon = this.game.add.tileSprite(0, 0, w, h, 'bg-horizon');

    this.mountains1 = this.game.add.tileSprite(0, 0, w, h, 'bg-mountains-01');
    this.mountains2 = this.game.add.tileSprite(0, 0, w, h, 'bg-mountains-02');
};

toot.environment.Background.prototype.update = function() {
    this.spaceBg.tilePosition.x -= 0.075;
    this.starsLg.tilePosition.x -= 0.100;
    this.spaceDs.tilePosition.x -= 0.125;
    this.starsSm.tilePosition.x -= 0.150;

    this.mountains1.tilePosition.x -= 0.20;
    this.mountains2.tilePosition.x -= 0.25;
};


toot.environment.Ground = function(game) {
    this.game = game;
};

toot.environment.Ground.prototype.preload = function() {
    this.game.load.image('ground', 'images/ground.jpg');
};

toot.environment.Ground.prototype.create = function() {
    var w = this.game.world.width;
    var h = this.game.world.height;

    var yPos = h - 97;
    this.ground = this.game.add.tileSprite(0, yPos, w, h, 'ground');

    this.game.physics.arcade.enable(this.ground);
    this.ground.body.immovable = true;

    // bug in phaser 2.3.0
    // see: http://www.html5gamedevs.com/topic/13856-problem-with-collide-method-from-physics-arcade-in-different-versions-of-phaser/?p=79032
    this.ground.physicsType = Phaser.SPRITE;
};

toot.environment.Ground.prototype.update = function() {
    this.ground.tilePosition.x -= 0.85;
};

toot.environment.Ground.prototype.getColliders = function() {
    return this.ground;
};

toot.environment.Vignette = function(game) {
    this.game = game;
};

toot.environment.Vignette.prototype.preload = function() {
    this.game.load.image('vignette', 'images/vignette.png');
};

toot.environment.Vignette.prototype.create = function() {
    var w = this.game.world.width;
    var h = this.game.world.height;
    this.v = this.game.add.sprite(0, 0, 'vignette');
};

toot.obstacle.Generator = function(game) {
    this.game = game;
};

toot.obstacle.Generator.prototype.preload = function() {
    this.game.load.image('rock', 'assets/diamond.png');
};

toot.obstacle.Generator.prototype.create = function() {
    var w = this.game.world.width;
    var h = this.game.world.height;

    this.rock = this.game.add.sprite(w, h / 2, 'rock');
};

toot.obstacle.Generator.prototype.update = function() {
    this.rock.position.x -= 2.5;
};

toot.ui.Distance = function(game) {
    this.game = game;
};

toot.ui.Distance.prototype.preload = function() {
};

toot.ui.Distance.prototype.create = function() {
    var w = this.game.world.width;
    this.display = this.game.add.text(16, 16, 'distance: 0', {
        fontSize: '32px', fill: '#fff'
    });
};

toot.ui.Distance.prototype.update = function() {
    this.display.text = 'distance: ' + Math.round(toot.currentDistance / 10);
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjaGFyYWN0ZXIvcGxheWVyLmpzIiwiZW52aXJvbm1lbnQvYmFja2dyb3VuZC5qcyIsImVudmlyb25tZW50L2dyb3VuZC5qcyIsImVudmlyb25tZW50L3ZpZ25ldHRlLmpzIiwib2JzdGFjbGUvZ2VuZXJhdG9yLmpzIiwidWkvZGlzdGFuY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdhbWUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHRvb3QgPSB7XG4gICAgLy9ncmF2aXR5OiAoMzAwICogMC4yNyksXG4gICAgZ3Jhdml0eTogMzAwLFxuICAgIGZhcnRTdHJlbmd0aDogMjUwLFxuICAgIGN1cnJlbnREaXN0YW5jZTogMCxcblxuICAgIC8vIG5hbWVzcGFjaW5nXG4gICAgY2hhcmFjdGVyOiB7fSxcbiAgICBlbnZpcm9ubWVudDoge30sXG4gICAgb2JzdGFjbGU6IHt9LFxuICAgIHVpOiB7fVxufTtcblxuXG5cbnZhciBydW4gPSBmdW5jdGlvbigpIHtcblxuICAgIHZhciBzdGF0cyA9IG5ldyBTdGF0cygpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc3RhdHMuZG9tRWxlbWVudCk7XG4gICAgc3RhdHMuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgc3RhdHMuZG9tRWxlbWVudC5zdHlsZS50b3AgPSAnMHB4JztcblxuICAgIHZhciBnYW1lID0gbmV3IFBoYXNlci5HYW1lKFxuICAgICAgICAxMzM0LCA3NTAsXG4gICAgICAgIFBoYXNlci5BVVRPLFxuICAgICAgICAnJywge1xuICAgICAgICAgICAgcHJlbG9hZDogcHJlbG9hZCxcbiAgICAgICAgICAgIGNyZWF0ZTogY3JlYXRlLFxuICAgICAgICAgICAgdXBkYXRlOiB1cGRhdGVcbiAgICAgICAgfSk7XG5cbiAgICAvL3ZhciBjdXJzb3JzO1xuICAgIHZhciBwbGF5ZXIgPSBuZXcgdG9vdC5jaGFyYWN0ZXIuUGxheWVyKGdhbWUpO1xuICAgIHZhciBncm91bmQgPSBuZXcgdG9vdC5lbnZpcm9ubWVudC5Hcm91bmQoZ2FtZSk7XG4gICAgdmFyIGJhY2tncm91bmQgPSBuZXcgdG9vdC5lbnZpcm9ubWVudC5CYWNrZ3JvdW5kKGdhbWUpO1xuXG4gICAgdmFyIG9ic3RhY2xlR2VuZXJhdG9yID0gbmV3IHRvb3Qub2JzdGFjbGUuR2VuZXJhdG9yKGdhbWUpO1xuICAgIHZhciB1aURpc3RhbmNlID0gbmV3IHRvb3QudWkuRGlzdGFuY2UoZ2FtZSk7XG5cbiAgICB2YXIgdmlnbmV0dGUgPSBuZXcgdG9vdC5lbnZpcm9ubWVudC5WaWduZXR0ZShnYW1lKTtcblxuXG4gICAgZnVuY3Rpb24gcHJlbG9hZCAoKSB7XG4gICAgICAgIGJhY2tncm91bmQucHJlbG9hZCgpO1xuICAgICAgICBncm91bmQucHJlbG9hZCgpO1xuICAgICAgICBwbGF5ZXIucHJlbG9hZCgpO1xuICAgICAgICB2aWduZXR0ZS5wcmVsb2FkKCk7XG5cbiAgICAgICAgb2JzdGFjbGVHZW5lcmF0b3IucHJlbG9hZCgpO1xuXG4gICAgICAgIHVpRGlzdGFuY2UucHJlbG9hZCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZSAoKSB7XG5cbiAgICAgICAgZ2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG5cbiAgICAgICAgZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgICAgICBnYW1lLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XG4gICAgICAgIGdhbWUuc2NhbGUucGFnZUFsaWduVmVydGljYWxseSA9IHRydWU7XG4gICAgICAgIGdhbWUuc2NhbGUuc2V0U2NyZWVuU2l6ZSh0cnVlKTtcbiAgICAgICAgZ2FtZS5zY2FsZS5yZWZyZXNoKCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGdhbWUgb2JqZWN0c1xuICAgICAgICBiYWNrZ3JvdW5kLmNyZWF0ZSgpO1xuICAgICAgICBncm91bmQuY3JlYXRlKCk7XG4gICAgICAgIHBsYXllci5jcmVhdGUoKTtcblxuXG4gICAgICAgIG9ic3RhY2xlR2VuZXJhdG9yLmNyZWF0ZSgpO1xuXG4gICAgICAgIHVpRGlzdGFuY2UuY3JlYXRlKCk7XG5cbiAgICAgICAgdmlnbmV0dGUuY3JlYXRlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgICBzdGF0cy5iZWdpbigpO1xuXG4gICAgICAgIGdhbWUucGh5c2ljcy5hcmNhZGUuY29sbGlkZShwbGF5ZXIuZ2V0Q29sbGlkZXJzKCksIGdyb3VuZC5nZXRDb2xsaWRlcnMoKSk7XG5cbiAgICAgICAgYmFja2dyb3VuZC51cGRhdGUoKTtcbiAgICAgICAgZ3JvdW5kLnVwZGF0ZSgpO1xuICAgICAgICBwbGF5ZXIudXBkYXRlKCk7XG5cbiAgICAgICAgb2JzdGFjbGVHZW5lcmF0b3IudXBkYXRlKCk7XG5cbiAgICAgICAgdWlEaXN0YW5jZS51cGRhdGUoKTtcblxuICAgICAgICB0b290LmN1cnJlbnREaXN0YW5jZSsrO1xuXG4gICAgICAgIHN0YXRzLmVuZCgpO1xuICAgIH1cblxufTtcbiIsIlxudG9vdC5jaGFyYWN0ZXIuUGxheWVyID0gZnVuY3Rpb24oZ2FtZSkge1xuICAgIHRoaXMuZ2FtZSA9IGdhbWU7XG4gICAgdGhpcy5zcHJpdGUgPSBudWxsO1xufTtcblxudG9vdC5jaGFyYWN0ZXIuUGxheWVyLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLmxvYWQuc3ByaXRlc2hlZXQoJ2R1ZGUnLCAnaW1hZ2VzL2R1ZGUucG5nJywgNjQsIDk2KTtcbn07XG5cbnRvb3QuY2hhcmFjdGVyLlBsYXllci5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gcGxheWVyXG4gICAgdmFyIHN0YXJ0WCA9IHRoaXMuZ2FtZS53b3JsZC53aWR0aCAqIDAuMTU7XG4gICAgdmFyIHN0YXJ0WSA9IHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQgLSAyNTY7XG5cbiAgICB0aGlzLnNwcml0ZSA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHN0YXJ0WCwgc3RhcnRZLCAnZHVkZScpO1xuICAgIHRoaXMuZ2FtZS5waHlzaWNzLmFyY2FkZS5lbmFibGUodGhpcy5zcHJpdGUpO1xuICAgIC8vdGhpcy5zcHJpdGUuYm9keS5ib3VuY2UueSA9IDAuMTtcbiAgICB0aGlzLnNwcml0ZS5ib2R5LmdyYXZpdHkueSA9IHRvb3QuZ3Jhdml0eTtcbiAgICB0aGlzLnNwcml0ZS5ib2R5LmNvbGxpZGVXb3JsZEJvdW5kcyA9IHRydWU7XG5cbiAgICAvL3RoaXMuc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdyaWdodCcsIFs1LCA2LCA3LCA4XSwgMTAsIHRydWUpO1xuICAgIHRoaXMuc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdydW4nLCBbNSwgNiwgNywgOF0sIDUsIHRydWUpO1xuICAgIHRoaXMuc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdsYW5kJywgWzUsIDYsIDcsIDhdLCAzLCB0cnVlKTtcbn07XG5cbnRvb3QuY2hhcmFjdGVyLlBsYXllci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oY3Vyc29ycykge1xuICAgIC8vICBSZXNldCB0aGUgcGxheWVycyB2ZWxvY2l0eSAobW92ZW1lbnQpXG4gICAgdGhpcy5zcHJpdGUuYm9keS52ZWxvY2l0eS54ID0gMDtcblxuICAgIC8vY29uc29sZS5sb2codGhpcy5zcHJpdGUuYm9keS52ZWxvY2l0eS55KTtcblxuICAgIGlmICh0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci5pc0Rvd24pIHtcbiAgICAgICAgdGhpcy5zcHJpdGUuYm9keS52ZWxvY2l0eS55ID0gdG9vdC5mYXJ0U3RyZW5ndGggKiAtMTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zcHJpdGUuYm9keS50b3VjaGluZy5kb3duKSB7XG4gICAgICAgIHRoaXMuc3ByaXRlLmFuaW1hdGlvbnMucGxheSgncnVuJyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRoaXMuc3ByaXRlLmJvZHkudmVsb2NpdHkueSA+IDAgJiZcbiAgICAgICAgICAgICB0aGlzLnNwcml0ZS5ib2R5LnZlbG9jaXR5LnkgPiAodG9vdC5mYXJ0U3RyZW5ndGggKiAwLjY2KSkge1xuICAgICAgICB0aGlzLnNwcml0ZS5hbmltYXRpb25zLnBsYXkoJ2xhbmQnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRoaXMuc3ByaXRlLmZyYW1lID0gODtcbiAgICB9XG5cbn07XG5cbnRvb3QuY2hhcmFjdGVyLlBsYXllci5wcm90b3R5cGUuZ2V0Q29sbGlkZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuc3ByaXRlO1xufTtcbiIsIlxudG9vdC5lbnZpcm9ubWVudC5CYWNrZ3JvdW5kID0gZnVuY3Rpb24oZ2FtZSkge1xuICAgIHRoaXMuZ2FtZSA9IGdhbWU7XG59O1xuXG50b290LmVudmlyb25tZW50LkJhY2tncm91bmQucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdhbWUubG9hZC5pbWFnZSgnYmctc3BhY2UnLCAnaW1hZ2VzL2JnLXNwYWNlLmpwZycpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmltYWdlKCdiZy1zdGFycy1zbWFsbCcsICdpbWFnZXMvYmctc3RhcnMtc21hbGwucG5nJyk7XG4gICAgdGhpcy5nYW1lLmxvYWQuaW1hZ2UoJ2JnLXN0YXJzLWRlbnNlJywgJ2ltYWdlcy9iZy1zdGFycy1zbWFsbC1kZW5zZS5wbmcnKTtcbiAgICB0aGlzLmdhbWUubG9hZC5pbWFnZSgnYmctc3RhcnMtbGFyZ2UnLCAnaW1hZ2VzL2JnLXN0YXJzLWxhcmdlLnBuZycpO1xuXG4gICAgdGhpcy5nYW1lLmxvYWQuaW1hZ2UoJ2JnLWhvcml6b24nLCAnaW1hZ2VzL2JnLWhvcml6b24tZ3JhZGllbnQucG5nJyk7XG4gICAgdGhpcy5nYW1lLmxvYWQuaW1hZ2UoJ2JnLW1vdW50YWlucy0wMScsICdpbWFnZXMvYmctbW91bnRhaW5zLTAxLnBuZycpO1xuICAgIHRoaXMuZ2FtZS5sb2FkLmltYWdlKCdiZy1tb3VudGFpbnMtMDInLCAnaW1hZ2VzL2JnLW1vdW50YWlucy0wMi5wbmcnKTtcbn07XG5cbnRvb3QuZW52aXJvbm1lbnQuQmFja2dyb3VuZC5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHcgPSB0aGlzLmdhbWUud29ybGQud2lkdGg7XG4gICAgdmFyIGggPSB0aGlzLmdhbWUud29ybGQuaGVpZ2h0O1xuICAgIHRoaXMuc3BhY2VCZyA9IHRoaXMuZ2FtZS5hZGQudGlsZVNwcml0ZSgwLCAwLCB3LCBoLCAnYmctc3BhY2UnKTtcbiAgICB0aGlzLnN0YXJzTGcgPSB0aGlzLmdhbWUuYWRkLnRpbGVTcHJpdGUoMCwgMCwgdywgaCwgJ2JnLXN0YXJzLWxhcmdlJyk7XG4gICAgdGhpcy5zcGFjZURzID0gdGhpcy5nYW1lLmFkZC50aWxlU3ByaXRlKDAsIDAsIHcsIGgsICdiZy1zdGFycy1kZW5zZScpO1xuICAgIHRoaXMuc3RhcnNTbSA9IHRoaXMuZ2FtZS5hZGQudGlsZVNwcml0ZSgwLCAwLCB3LCBoLCAnYmctc3RhcnMtc21hbGwnKTtcblxuICAgIHRoaXMuaG9yaXpvbiA9IHRoaXMuZ2FtZS5hZGQudGlsZVNwcml0ZSgwLCAwLCB3LCBoLCAnYmctaG9yaXpvbicpO1xuXG4gICAgdGhpcy5tb3VudGFpbnMxID0gdGhpcy5nYW1lLmFkZC50aWxlU3ByaXRlKDAsIDAsIHcsIGgsICdiZy1tb3VudGFpbnMtMDEnKTtcbiAgICB0aGlzLm1vdW50YWluczIgPSB0aGlzLmdhbWUuYWRkLnRpbGVTcHJpdGUoMCwgMCwgdywgaCwgJ2JnLW1vdW50YWlucy0wMicpO1xufTtcblxudG9vdC5lbnZpcm9ubWVudC5CYWNrZ3JvdW5kLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNwYWNlQmcudGlsZVBvc2l0aW9uLnggLT0gMC4wNzU7XG4gICAgdGhpcy5zdGFyc0xnLnRpbGVQb3NpdGlvbi54IC09IDAuMTAwO1xuICAgIHRoaXMuc3BhY2VEcy50aWxlUG9zaXRpb24ueCAtPSAwLjEyNTtcbiAgICB0aGlzLnN0YXJzU20udGlsZVBvc2l0aW9uLnggLT0gMC4xNTA7XG5cbiAgICB0aGlzLm1vdW50YWluczEudGlsZVBvc2l0aW9uLnggLT0gMC4yMDtcbiAgICB0aGlzLm1vdW50YWluczIudGlsZVBvc2l0aW9uLnggLT0gMC4yNTtcbn07XG4iLCJcbnRvb3QuZW52aXJvbm1lbnQuR3JvdW5kID0gZnVuY3Rpb24oZ2FtZSkge1xuICAgIHRoaXMuZ2FtZSA9IGdhbWU7XG59O1xuXG50b290LmVudmlyb25tZW50Lkdyb3VuZC5wcm90b3R5cGUucHJlbG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZ2FtZS5sb2FkLmltYWdlKCdncm91bmQnLCAnaW1hZ2VzL2dyb3VuZC5qcGcnKTtcbn07XG5cbnRvb3QuZW52aXJvbm1lbnQuR3JvdW5kLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdyA9IHRoaXMuZ2FtZS53b3JsZC53aWR0aDtcbiAgICB2YXIgaCA9IHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQ7XG5cbiAgICB2YXIgeVBvcyA9IGggLSA5NztcbiAgICB0aGlzLmdyb3VuZCA9IHRoaXMuZ2FtZS5hZGQudGlsZVNwcml0ZSgwLCB5UG9zLCB3LCBoLCAnZ3JvdW5kJyk7XG5cbiAgICB0aGlzLmdhbWUucGh5c2ljcy5hcmNhZGUuZW5hYmxlKHRoaXMuZ3JvdW5kKTtcbiAgICB0aGlzLmdyb3VuZC5ib2R5LmltbW92YWJsZSA9IHRydWU7XG5cbiAgICAvLyBidWcgaW4gcGhhc2VyIDIuMy4wXG4gICAgLy8gc2VlOiBodHRwOi8vd3d3Lmh0bWw1Z2FtZWRldnMuY29tL3RvcGljLzEzODU2LXByb2JsZW0td2l0aC1jb2xsaWRlLW1ldGhvZC1mcm9tLXBoeXNpY3MtYXJjYWRlLWluLWRpZmZlcmVudC12ZXJzaW9ucy1vZi1waGFzZXIvP3A9NzkwMzJcbiAgICB0aGlzLmdyb3VuZC5waHlzaWNzVHlwZSA9IFBoYXNlci5TUFJJVEU7XG59O1xuXG50b290LmVudmlyb25tZW50Lkdyb3VuZC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ncm91bmQudGlsZVBvc2l0aW9uLnggLT0gMC44NTtcbn07XG5cbnRvb3QuZW52aXJvbm1lbnQuR3JvdW5kLnByb3RvdHlwZS5nZXRDb2xsaWRlcnMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ncm91bmQ7XG59O1xuIiwidG9vdC5lbnZpcm9ubWVudC5WaWduZXR0ZSA9IGZ1bmN0aW9uKGdhbWUpIHtcbiAgICB0aGlzLmdhbWUgPSBnYW1lO1xufTtcblxudG9vdC5lbnZpcm9ubWVudC5WaWduZXR0ZS5wcm90b3R5cGUucHJlbG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZ2FtZS5sb2FkLmltYWdlKCd2aWduZXR0ZScsICdpbWFnZXMvdmlnbmV0dGUucG5nJyk7XG59O1xuXG50b290LmVudmlyb25tZW50LlZpZ25ldHRlLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdyA9IHRoaXMuZ2FtZS53b3JsZC53aWR0aDtcbiAgICB2YXIgaCA9IHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQ7XG4gICAgdGhpcy52ID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoMCwgMCwgJ3ZpZ25ldHRlJyk7XG59O1xuIiwidG9vdC5vYnN0YWNsZS5HZW5lcmF0b3IgPSBmdW5jdGlvbihnYW1lKSB7XG4gICAgdGhpcy5nYW1lID0gZ2FtZTtcbn07XG5cbnRvb3Qub2JzdGFjbGUuR2VuZXJhdG9yLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5nYW1lLmxvYWQuaW1hZ2UoJ3JvY2snLCAnYXNzZXRzL2RpYW1vbmQucG5nJyk7XG59O1xuXG50b290Lm9ic3RhY2xlLkdlbmVyYXRvci5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHcgPSB0aGlzLmdhbWUud29ybGQud2lkdGg7XG4gICAgdmFyIGggPSB0aGlzLmdhbWUud29ybGQuaGVpZ2h0O1xuXG4gICAgdGhpcy5yb2NrID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUodywgaCAvIDIsICdyb2NrJyk7XG59O1xuXG50b290Lm9ic3RhY2xlLkdlbmVyYXRvci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5yb2NrLnBvc2l0aW9uLnggLT0gMi41O1xufTtcbiIsInRvb3QudWkuRGlzdGFuY2UgPSBmdW5jdGlvbihnYW1lKSB7XG4gICAgdGhpcy5nYW1lID0gZ2FtZTtcbn07XG5cbnRvb3QudWkuRGlzdGFuY2UucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbigpIHtcbn07XG5cbnRvb3QudWkuRGlzdGFuY2UucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3ID0gdGhpcy5nYW1lLndvcmxkLndpZHRoO1xuICAgIHRoaXMuZGlzcGxheSA9IHRoaXMuZ2FtZS5hZGQudGV4dCgxNiwgMTYsICdkaXN0YW5jZTogMCcsIHtcbiAgICAgICAgZm9udFNpemU6ICczMnB4JywgZmlsbDogJyNmZmYnXG4gICAgfSk7XG59O1xuXG50b290LnVpLkRpc3RhbmNlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRpc3BsYXkudGV4dCA9ICdkaXN0YW5jZTogJyArIE1hdGgucm91bmQodG9vdC5jdXJyZW50RGlzdGFuY2UgLyAxMCk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9